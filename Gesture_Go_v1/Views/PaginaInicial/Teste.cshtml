@model IEnumerable<Gesture_Go_v1.Models.Imagem>

@{

    var tempo = DateTime.Now.AddSeconds(ViewBag.segundos);
    var tempoRestante = TimeSpan.FromTicks(tempo.Ticks - DateTime.Now.Ticks).TotalSeconds;
    ViewBag.Title = "Teste";
    int count = 0;
}



<div class="col-12 mb-3">
    <div class="p-3 m-1 ml-2 card bg-light shadow" style="border-radius: 5px 5px 20px 20px;">
        <h2>Teste</h2>
        <div><span id="TimerMinutos"></span>:<span id="TimerSegundos"></span></div>


        <div id="carouselExampleControls" class="carousel slide" data-interval="0" data-ride="carousel">
            <div class="carousel-inner">


                @{ foreach (var item in Model)
                    {
                        <div class="carousel-item @( (count == 0)? "active" : "") ">

                            @Html.HiddenFor(modelItem => item.img_id)
                            <img src="~/Imagens/@item.img_nome?@DateTime.Now.ToString("yyyyMMddHHmmss")" class="d-block w-100" />
                        </div>
                        count++;
                    }
                }

            </div>
            <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>




</div>

<script>

    var TempoRes = @tempoRestante;
    var ContSeg = TempoRes % 60;

    function FormataNumero(number) {
        if (number < 10) return '0' + number;
        else return '' + number;
    }


    function startTick() {
        document.getElementById('TimerSegundos').innerText = FormataNumero(ContSeg);
        document.getElementById('TimerMinutos').innerText = FormataNumero(parseInt(TempoRes/60));


        var _tick = setInterval(function () {

            if (TempoRes == 0) {$('#carouselExampleControls').carousel('next');}
                if (TempoRes >= 0) {

                document.getElementById('TimerSegundos').innerText = FormataNumero(ContSeg);
                document.getElementById('TimerMinutos').innerText = FormataNumero(parseInt(TempoRes / 60));
                if (ContSeg == 0 ) { ContSeg = 60; }
                    TempoRes--;
                    ContSeg--;
                }
                else {
                    TempoRes = @tempoRestante;
                    ContSeg = TempoRes % 60;


                }

            }, 1000);
    }

    startTick();

</script>
